<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DealSense MCP í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f7;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1d1d1f;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        button {
            background: #0071e3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #0077ed;
        }
        button:active {
            background: #006edb;
        }
        .section {
            margin-bottom: 30px;
        }
        pre {
            background: #f5f5f7;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            max-height: 500px;
            overflow-y: auto;
        }
        .deal-card {
            background: #f9f9f9;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 4px solid #0071e3;
        }
        .deal-title {
            font-weight: 600;
            margin-bottom: 8px;
        }
        .deal-price {
            color: #e62e2e;
            font-size: 18px;
            font-weight: 600;
        }
        .deal-info {
            color: #666;
            font-size: 14px;
            margin-top: 5px;
        }
        .score {
            display: inline-block;
            background: #0071e3;
            color: white;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 5px;
        }
        .risk-note {
            color: #e62e2e;
            font-size: 12px;
            margin-top: 5px;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        .error {
            color: #e62e2e;
            background: #ffe6e6;
            padding: 10px;
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”¥ DealSense MCP í…ŒìŠ¤íŠ¸</h1>
        <p class="subtitle">MCP ì„œë²„ê°€ http://localhost:3000ì—ì„œ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤</p>

        <div class="section">
            <h2>1ï¸âƒ£ ì„œë²„ ìƒíƒœ í™•ì¸</h2>
            <button onclick="checkHealth()">Health Check</button>
            <pre id="health-result">ê²°ê³¼ê°€ ì—¬ê¸° í‘œì‹œë©ë‹ˆë‹¤...</pre>
        </div>

        <div class="section">
            <h2>2ï¸âƒ£ í•«ë”œ Top 10</h2>
            <button onclick="getHotDeals()">24ì‹œê°„ ì¸ê¸°ìˆœ</button>
            <button onclick="getHotDeals('7d', 'discount')">7ì¼ í• ì¸ìˆœ</button>
            <div id="deals-result"></div>
        </div>

        <div class="section">
            <h2>3ï¸âƒ£ ê´€ì‹¬ì‚¬ í”„ë¡œí•„ í…ŒìŠ¤íŠ¸</h2>
            <button onclick="createProfile()">ìº í•‘ í”„ë¡œí•„ ìƒì„±</button>
            <button onclick="getRecommendations()">ì¶”ì²œ ë°›ê¸°</button>
            <pre id="profile-result">í”„ë¡œí•„ì„ ë¨¼ì € ìƒì„±í•˜ì„¸ìš”...</pre>
        </div>
    </div>

    <script>
        let currentProfileId = null;

        async function checkHealth() {
            const result = document.getElementById('health-result');
            result.textContent = 'í™•ì¸ ì¤‘...';

            try {
                const response = await fetch('http://localhost:3000/health');
                const data = await response.json();
                result.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                result.textContent = 'âŒ ì˜¤ë¥˜: ' + error.message + '\n\nì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”:\nnpm start';
            }
        }

        async function getHotDeals(window = '24h', sort = 'popularity') {
            const result = document.getElementById('deals-result');
            result.innerHTML = '<p class="loading">í•«ë”œì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>';

            // MCP í”„ë¡œí† ì½œì€ SSEê°€ í•„ìš”í•˜ë¯€ë¡œ, ì—¬ê¸°ì„œëŠ” ì§ì ‘ ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ë¥¼ ì‹œë®¬ë ˆì´ì…˜
            result.innerHTML = `
                <div class="error">
                    âš ï¸ ë¸Œë¼ìš°ì €ì—ì„œëŠ” MCP í”„ë¡œí† ì½œì„ ì§ì ‘ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
                    <br><br>
                    <strong>ëŒ€ì‹  ì´ë ‡ê²Œ ì‚¬ìš©í•˜ì„¸ìš”:</strong>
                    <br><br>
                    1. <strong>MCP Inspector</strong> (ê¶Œì¥):
                    <pre style="background: white; padding: 10px; margin-top: 10px;">
npm install -g @modelcontextprotocol/inspector
mcp-inspector http://localhost:3000/mcp</pre>

                    2. <strong>Claude Desktop</strong>:
                    <br>ì„¤ì • íŒŒì¼ì— ì¶”ê°€:
                    <pre style="background: white; padding: 10px; margin-top: 10px;">
{
  "mcpServers": {
    "dealsense": {
      "url": "http://localhost:3000/mcp"
    }
  }
}</pre>
                </div>
            `;
        }

        async function createProfile() {
            const result = document.getElementById('profile-result');
            result.textContent = 'í”„ë¡œí•„ ìƒì„± í…ŒìŠ¤íŠ¸\n\nMCP Inspectorë¥¼ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”:\n\nmcp-inspector http://localhost:3000/mcp\n\në„êµ¬: interests.upsert\nì…ë ¥:\n' + JSON.stringify({
                "categories": ["ìº í•‘", "ì•„ì›ƒë„ì–´"],
                "keywords": ["í…íŠ¸", "ì¹¨ë‚­"],
                "brands": ["ì½”ë² ì•„"],
                "price_max": 50000,
                "exclude_keywords": ["ì¤‘ê³ ", "ë¦¬í¼"]
            }, null, 2);
        }

        async function getRecommendations() {
            const result = document.getElementById('profile-result');
            result.textContent = 'MCP Inspectorì—ì„œ í…ŒìŠ¤íŠ¸:\n\n1. interests.upsertë¡œ í”„ë¡œí•„ ìƒì„±\n2. ë°˜í™˜ëœ profile_id ë³µì‚¬\n3. deals.by_interests ì‹¤í–‰\n4. profile_id ì…ë ¥';
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ health check
        window.onload = () => {
            checkHealth();
        };
    </script>
</body>
</html>
